<!DOCTYPE html>
<html>
<!--
#
# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at
# 
# http://www.apache.org/licenses/LICENSE-2.0
# 
# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
#  KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.
#
-->
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name = "format-detection" content = "telephone=no"/>
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width;" />
        <link rel="stylesheet" type="text/css" href="css/index.css" /> <!-- 2048-by-1536 resolution at 264 pixels per inch (ppi) -->
        <link rel="stylesheet" type="text/css" href="css/jquery.percentageloader-0.1.css" />
        
        <link rel="stylesheet" type="text/css" href="css/kendo.mobile.all.min.css" />
        
        <title>LemonAid</title>
    </head>
    <body>
    	<div class="barBuffer" style="height: 20px;"></div>
        <div class="app">
            <div id="statusBar">
            	<div id="connectionCheck">
            		<label id="netCon" class="statusIcon"></label>
            		<label id="dbCon" class="statusIcon"></label>
            		<label id="socketConn" class="statusIcon"></label>
            	</div> 
            	<button id="disconnectConn">Disconnect</button>	
            </div>
            
            <div id="analysisPage" class="appPage">
            	 
            </div>
            
           

            
            <!--<div id="navBar">
            	<div id="navItems">
            		<button id="toHome">Home</button>
            		<button id="toAnalysis">Analysis</button>
            		
            	</div>
            </div>-->
            
        </div>
        <script type="text/javascript" src="js/jquery.min.js"></script>
        <script type="text/javascript" src="cordova-2.0.0.js"></script>
        
        <script type="text/javascript" src="js/websocket.js"></script>
        
        <script type="text/javascript" src="js/highstock.js"></script>
        <script type="text/javascript" src="js/exporting.js"></script>
        
        <script type="text/javascript" src="js/TabBar.js"></script>
       
         
        <script type="text/javascript" src="http://localhost:8080/socket.io/socket.io.js"></script>
        <!--<script type="text/javascript" src="http://192.168.1.1:8080/socket.io/socket.io.js"></script>-->
        <script type="text/javascript">
            var isNetConnected = false;
            var isDbConnected = false;
            var isSocketConnected = false;
            var socket = -1;
            
            var speedData = 0;
            
            /**
             *  steps to do when cordova is ready 
             */
            
            document.addEventListener("deviceready", function() {
    console.log("PhoneGap ready")

    
    
    
    plugins.tabBar.createItem("dashboard", "Dashboard", "www/img/dashboardIcon.png", {
        onSelect: function() {
        	window.location.href = "dashboard.html"    
        }
    })
    
    plugins.tabBar.createItem("trip", "Trip", "www/img/dashboardIcon.png", {
        onSelect: function() {
            window.location.href = "trip.html"
        }
    })
   

	plugins.tabBar.createItem("analysis", "Analysis", "/www/img/analysisIcon.png", {
        onSelect: function() {
            //window.location.href = "analysis.html";
        }
    })
    
    
    
    socket = io.connect('http://localhost:8080');
            	//socket = io.connect('http://192.168.1.1:8080');
            	//socket.emit('my other event', { hello: 2 });
            	
            	socket.on('news', function (data) {
            		//gauge.set(data.hello);
            		
            		//loader.setValue(data.hello + 'kmph');
            		//loader.setProgress(data.hello/20);
            		
            		//speeder.position(data.hello);
            		//speeder.accelerate(data.hello);
					//speeder.scrollTo(data.hello*10);
					
					speedData = data.hello;
					
            		$('#socketConn').text('Socket Connected ' + data.hello);
					isSocketConnected = true;  
		  		});
            
    
    
    }, false)
              
             
             
             
                   
            /**
             *  check connection 
             */
            function checkConnection(){
            	console.log('connection check');
            	var networkState = navigator.network.connection.type;

			    var states = {};
			    states[Connection.UNKNOWN]  = 'Unknown connection';
			    states[Connection.ETHERNET] = 'Ethernet connection';
			    states[Connection.WIFI]     = 'WiFi connection';
			    states[Connection.CELL_2G]  = 'Cell 2G connection';
			    states[Connection.CELL_3G]  = 'Cell 3G connection';
			    states[Connection.CELL_4G]  = 'Cell 4G connection';
			    states[Connection.NONE]     = 'No network connection';
			
			    alert('Connection type: ' + states[networkState]);
			    
			    if(states[Connection.WIFI] == 'WiFi connection'){
			    	$('#netCon').text('WiFi connected');
			    	isNetConnected = true;
			    }
            }
            
            /**
             *  handle online event
             */
            function onOnline(){
            	$('#netCon').text('WiFi connected');
			    isNetConnected = true;
            }
            
            /**
             *  handle offline event
             */
            function onOffline(){
            	$('#netCon').text('WiFi disconnected');
			    isNetConnected = false;
            }
            
            /**
			 *  disconnect the socket
			 */
			$('#disconnectConn').click(function(){
				//alert('Disconnect Socket');
				
				navigator.notification.alert(
				    "Disconnect Socket",
				    callBackFunctionB, // Specify a function to be called 
				    'LemonAid',
				    "OK"
				);
				
				socket.disconnect();
				$('#socketConn').text('Socket disonnected');
				isSocketConnected = false;
			});
			
			/**
			 *  callback for alert 
			 */
			function callBackFunctionB(){
			    console.log('Socket Disconnected - ok');
			}
			
			
			$('#toHome').click(function(){
				window.location.href = 'index.html';
			});
            
   

            
            
            
        </script>
    </body>
</html>
